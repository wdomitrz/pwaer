<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
  </head>
  <body>
    <h1>My PWA</h1>
    <script>
      const iconSize = 192;
      const url = new URL(window.location.href);
      const params = new URLSearchParams(url.search);
      if (params.has("url")) {
        console.log("asdf", params.get("url"));
        window.location.replace("https://github.com/wdomitrz/chess_clock");
      } else {
        console.log("zxcv", params.entries());
      }

      const manifest = {
        name: "DynApp " + params.get("id"),
        id: "DynApp " + params.get("id"),
        display: "standalone",
        start_url: window.location.href + "?url=zxcv",
        icons: [
          {
            id: params.get("id"),
            src: "https://raw.githubusercontent.com/wdomitrz/chess_clock/refs/heads/master/icon.svg",
            sizes: "any",
            type: "image/svg+xml",
          },
        ],
        scope_extensions: [{ type: "origin", origin: "https://github.com" }],
      };

      setManifest(manifest);

      function setManifest(manifest) {
        const link = document.createElement("link");
        link.rel = "manifest";
        const b64manifest = btoa(JSON.stringify(manifest));
        link.href = "data:application/json;base64," + b64manifest;
        document.head.appendChild(link);
      }
    </script>
  </body>
</html>
